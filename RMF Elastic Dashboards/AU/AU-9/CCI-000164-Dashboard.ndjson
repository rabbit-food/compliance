{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#fa7d07","description":"","name":"au-9"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:45:42.636Z","created_by":"u_elastic_found","id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T14:45:42.636Z","updated_by":"u_elastic_found","version":"WzIxNjEsMV0="}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"description":"This visualization displays the top audit files or processes that are subject to access, modification, or deletion attempts. This is a vital overview for the entire **AU-9** control, encompassing aspects of **CCI-000162, CCI-000163, CCI-000164, CCI-001494, and CCI-001495**. \n\n**Why this visualization works:** It helps analysts quickly identify the most frequently targeted audit resources (logs or tools). A sudden spike or consistent activity on a specific audit file or process, especially by unauthorized users, can indicate a focused attack or a critical misconfiguration. This allows for targeted investigation on the most critical audit components, ensuring comprehensive protection. \n\n**How an analyst can use it:** Monitor for any audit files or processes with unusually high activity. Drill down into specific 'file.path' or 'process.name' entries to see the detailed events. If unauthorized attempts are concentrated on a few critical audit resources, this visualization helps pinpoint the immediate areas requiring attention for AU-9 compliance across all related CCIs. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11":{"columnOrder":["b9da6ea0-2a0f-4656-953f-c97f1b381ef2","e7eabdfb-59f1-4a23-a57d-7fd6012339ef","0731af5e-a459-4821-bb6d-7ed96645c88e"],"columns":{"0731af5e-a459-4821-bb6d-7ed96645c88e":{"dataType":"number","isBucketed":false,"label":"Count of records","operationType":"count","params":{"emptyAsNull":true},"scale":"ratio","sourceField":"___records___"},"b9da6ea0-2a0f-4656-953f-c97f1b381ef2":{"dataType":"string","isBucketed":true,"label":"Top 8 values of file.path","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"0731af5e-a459-4821-bb6d-7ed96645c88e","type":"column"},"orderDirection":"desc","otherBucket":false,"parentFormat":{"id":"terms"},"size":8},"scale":"ordinal","sourceField":"file.path"},"e7eabdfb-59f1-4a23-a57d-7fd6012339ef":{"dataType":"string","isBucketed":true,"label":"Top 6 values of process.name","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"0731af5e-a459-4821-bb6d-7ed96645c88e","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":6},"scale":"ordinal","sourceField":"process.name"}},"incompleteColumns":{},"sampling":1}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"(file.path:\"/var/log/audit/*\" OR file.path:\"C:\\Windows\\System32\\winevt\\Logs\\*\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \"NT AUTHORITY\\SYSTEM\" OR LocalSystem OR NetworkService) AND event.outcome:success) "},"visualization":{"axisTitlesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"fittingFunction":"Linear","gridlinesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"labelsOrientation":{"x":0,"yLeft":0,"yRight":0},"layers":[{"accessors":["0731af5e-a459-4821-bb6d-7ed96645c88e"],"colorMapping":{"assignments":[],"colorMode":{"type":"categorical"},"paletteId":"default","specialAssignments":[{"color":{"type":"loop"},"rule":{"type":"other"},"touched":false}]},"layerId":"d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","layerType":"data","seriesType":"bar_stacked","splitAccessor":"b9da6ea0-2a0f-4656-953f-c97f1b381ef2","xAccessor":"e7eabdfb-59f1-4a23-a57d-7fd6012339ef"}],"legend":{"isVisible":true,"position":"right"},"preferredSeriesType":"bar_stacked","tickLabelsVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"valueLabels":"hide"}},"title":"[AU-9] Top Targeted Audit Resources (All AU-9 CCIs)","visualizationType":"lnsXY"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T14:07:26.755Z","created_by":"u_elastic_found","id":"595d3392-1102-4220-afa0-df19d4164e50","managed":false,"references":[{"id":"logs-*","name":"indexpattern-datasource-layer-d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-07-23T14:07:26.755Z","updated_by":"u_elastic_found","version":"WzE3NzYsMl0="}
{"attributes":{"description":"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \n\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \n\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)\",\"type\":\"pie\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"split\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.outcome\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"segment\"}],\"params\":{\"addLegend\":true,\"addTooltip\":true,\"distinctColors\":false,\"donut\":false,\"emptySizeRatio\":0.3,\"is={true}\":true,\"isDonut\":true,\"labels\":{\"last_level\":false,\"percentDecimals\":2,\"position\":\"default\",\"show\":true,\"truncate\":100,\"values\":true,\"valuesFormat\":\"percent\"},\"legendDisplay\":\"hide\",\"legendPosition\":\"right\",\"maxLegendLines\":1,\"nestedLegend\":false,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"radius\":\"90%\",\"row\":true,\"truncateLegend\":true,\"type\":\"pie\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-outcome-action-breakdown","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T02:01:51.878Z","updated_by":"u_elastic_found","version":"WzE2NzksMl0="}
{"attributes":{"description":"This visualization displays the total count of all access attempts (both successful and failed) on audit information or audit tools. This metric is foundational for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \n\n**Why this visualization works:** It provides a quick, high-level understanding of the overall activity directed at protecting audit data. A sudden or sustained increase in this number, even if most attempts are failed, warrants further investigation as it can indicate increased threat activity or misconfigurations. \n\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for audit information protection. A continuously high count, even if not spiking, suggests a need for deeper investigation into your audit security. Remember that high numbers aren't always bad, but they should be explainable by authorized activity. For **CCI-000163** and **CCI-000164**, a high total count might indicate frequent integrity checks or, conversely, frequent attempts to compromise integrity.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-000162, CCI-000163, CCI-000164] Total Audit Information Access Attempts","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"Total Attempts\",\"emptyAsNull\":false},\"schema\":\"metric\",\"type\":\"count\"}],\"params\":{\"addLegend\":false,\"addTooltip\":true,\"fontSize\":\"60\",\"metric\":{\"colorSchema\":\"Green to Red\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"invertColors\":false,\"labels\":{\"show\":true},\"metricColorMode\":\"None\",\"percentageMode\":false,\"style\":{\"bgColor\":false,\"bgFill\":\"#000\",\"fontSize\":60,\"labelColor\":false,\"subText\":\"\"},\"useRanges\":false},\"type\":\"metric\"},\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Total Audit Information Access Attempts\",\"type\":\"metric\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-cci-core-total-attempts","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-21T14:54:13.032Z","updated_by":"u_elastic_found","version":"WzUzMywxXQ=="}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"description":"This section provides visualizations to help you assess compliance with CCI-000164, focusing on the protection of audit information and audit tools. You'll find a series of visualizations designed to highlight unauthorized access, modification, and deletion attempts on audit logs and tools. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any anomalies or failed protection mechanisms. A high number of failed attempts could indicate active threats or misconfigurations. Pay close attention to the 'user.name' field to ensure that only authorized accounts are interacting with audit data. This visualization now displays the health status of audit information protection for CCI-000164 based on the anomaly scores from associated ML jobs.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-000162-000163-000164-access-attempts-trend OR job_id:au-9-cci-000162-000163-000164-failed-access-trend\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000164] Protection of Audit Information: Monitor Log & Tool Integrity ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000164] Protection of Audit Information: Monitor Log & Tool Integrity ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":0,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-red\",\"operator\":\"gte\"},{\"value\":20,\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-yellow\",\"operator\":\"gte\"},{\"value\":100,\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-green\",\"operator\":\"gte\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-000162-000163-000164-access-attempts-trend OR job_id:au-9-cci-000162-000163-000164-failed-access-trend\"},\"gauge_color_rules\":[],\"gauge_inner_width\":10,\"gauge_style\":\"half\",\"gauge_width\":10,\"id\":\"cci-000164-title\",\"interval\":\"\",\"isModelInvalid\":false,\"max_lines_legend\":1,\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"CCI-000164 Health Status\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"point_size\":1,\"separate_axis\":0,\"series_drop_last_bucket\":0,\"split_mode\":\"everything\",\"stacked\":\"none\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"tooltip_mode\":\"show_all\",\"truncate_legend\":1,\"type\":\"metric\",\"use_kibana_indexes\":true,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:38:27.855Z","created_by":"u_elastic_found","id":"cci-000164-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":".ml-anomalies-*","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-22T15:51:06.074Z","updated_by":"u_elastic_found","version":"WzEyODUsMl0="}
{"attributes":{"description":"This table provides a detailed breakdown of the most significant anomalies related to audit information access.\n\n**Why this visualization works:**\nIt offers granular, actionable intelligence. Instead of just knowing an anomaly happened, you can see the 'who, what, and where'â€”the users, hosts, processes, and files that influenced the anomaly score. This is critical for rapid investigation and response.\n\n**How an analyst can use it:**\nFilter for high anomaly scores (e.g., anomaly_score >= 75) to focus on the most critical events. Sort by `influencers.user.name` or `influencers.host.name` to identify systems or accounts exhibiting the most unusual behavior. This data helps you pinpoint the source of a potential compromise or misconfiguration.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id : (\\\"au-9-cci-000162-000163-000164-access-attempts-trend\\\" or \\\"au-9-cci-000162-000163-000164-failed-access-trend\\\") and anomaly_score >= 50\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9-CCIs-000162,163,164] ML - Detailed Audit Access Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9-CCIs-000162,163,164] ML - Detailed Audit Access Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"job_id\",\"orderBy\":\"4\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\"},\"schema\":\"metric\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:30:33.016Z","created_by":"u_elastic_found","id":"au-9-cci-000162-000163-000164-ml-detailed-anomalies","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T15:00:36.434Z","updated_by":"u_elastic_found","version":"WzE5NjcsMl0="}
{"attributes":{"description":"This table provides a detailed breakdown of individual events related to access attempts on audit information or audit tools. This is essential for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \n\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, process, file involved, and the specific action attempted. This is crucial for in-depth investigation and identifying 'who', 'what', and 'where' regarding interactions with audit data, directly supporting the granular analysis required for compliance. \n\n**How an analyst can use it:** Sort by '@timestamp' to see the most recent events, or by 'user.name' to identify common sources of activity. Examine 'file.path' and 'process.name' to pinpoint specific audit resources being targeted. The 'event.outcome' field is critical for distinguishing between successful and failed attempts. For compliance, you should be able to explain any successful access by unauthorized users, or a high volume of failed attempts which might indicate active threats. For **CCI-000163** and **CCI-000164**, specifically look for any modification or deletion actions that were unauthorized. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to get a targeted view.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-000162, CCI-000163, CCI-000164] Detailed Audit Information Access Events","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"Event Count\",\"emptyAsNull\":false},\"schema\":\"metric\",\"type\":\"count\"},{\"enabled\":true,\"id\":\"2\",\"params\":{\"excludeIsRegex\":true,\"field\":\"@timestamp\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"3\",\"params\":{\"excludeIsRegex\":true,\"field\":\"host.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"4\",\"params\":{\"excludeIsRegex\":true,\"field\":\"user.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"5\",\"params\":{\"excludeIsRegex\":true,\"field\":\"process.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"6\",\"params\":{\"excludeIsRegex\":true,\"field\":\"file.path\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"7\",\"params\":{\"excludeIsRegex\":true,\"field\":\"event.outcome\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"}],\"params\":{\"autoFitRowToContent\":false,\"perPage\":10,\"percentageCol\":\"\",\"showMetricsAtAllLevels\":true,\"showPartialRows\":false,\"showToolbar\":false,\"showTotal\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"totalFunc\":\"sum\"},\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Detailed Audit Information Access Events\",\"type\":\"table\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-cci-core-detailed-events","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-21T14:54:05.695Z","updated_by":"u_elastic_found","version":"WzUzMiwxXQ=="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Audit Information Access Attempts Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"ad7e4d0c-2731-41e3-a9b8-7ff9ffdf8b5d\",\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"attributes\":{\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Audit Information Access Attempts Trend (converted)\",\"description\":\"This visualization displays a time-series trend of all access attempts (successful and failed) on audit information or audit tools. This is crucial for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \\n\\n**Why this visualization works:** It provides a quick visual of spikes or consistent activity over time, allowing analysts to spot unusual patterns or potential attacks. Seeing both successful and failed attempts helps paint a complete picture of interaction with audit data, offering insights into both successful protection and attempted breaches. This trend helps you assess the overall security posture and effectiveness of your protection mechanisms for audit information over time. \\n\\n**How an analyst can use it:** Look for sudden increases in attempts, especially unexpected successful ones by unauthorized users, or a high volume of failed attempts. Hover over data points to see the exact count at a given time. Use the 'event.outcome' breakdown to understand if attempts are being successfully thwarted or if there are successful unauthorized accesses. For **CCI-000163** and **CCI-000164**, pay close attention to any successful attempts that might indicate a compromise of log or tool integrity. Remember to use the global filters at the top of the Kibana dashboard to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\"logs-*\",\"name\":\"indexpattern-datasource-layer-e6d810f3-4363-4bfb-b0b2-4c3ae3f80037\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"e6d810f3-4363-4bfb-b0b2-4c3ae3f80037\",\"accessors\":[\"191ae1c0-5117-49c0-bf05-82e9e1ffa31d\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"6f3f27c7-0768-4d58-bae9-21d2b8e0e8c1\",\"simpleView\":false,\"splitAccessor\":\"58dbc444-73de-46d4-b34d-41404f0f93dd\",\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"191ae1c0-5117-49c0-bf05-82e9e1ffa31d\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"e6d810f3-4363-4bfb-b0b2-4c3ae3f80037\":{\"ignoreGlobalFilters\":false,\"columns\":{\"6f3f27c7-0768-4d58-bae9-21d2b8e0e8c1\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"58dbc444-73de-46d4-b34d-41404f0f93dd\":{\"label\":\"event.outcome: Descending\",\"dataType\":\"string\",\"operationType\":\"terms\",\"scale\":\"ordinal\",\"sourceField\":\"event.outcome\",\"isBucketed\":true,\"params\":{\"size\":5,\"orderBy\":{\"type\":\"column\",\"columnId\":\"191ae1c0-5117-49c0-bf05-82e9e1ffa31d\"},\"orderDirection\":\"desc\",\"otherBucket\":false,\"missingBucket\":false,\"parentFormat\":{\"id\":\"terms\"},\"include\":[],\"exclude\":[],\"includeIsRegex\":false,\"excludeIsRegex\":false},\"customLabel\":true},\"191ae1c0-5117-49c0-bf05-82e9e1ffa31d\":{\"label\":\"Count\",\"dataType\":\"number\",\"operationType\":\"count\",\"isBucketed\":false,\"scale\":\"ratio\",\"sourceField\":\"___records___\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"6f3f27c7-0768-4d58-bae9-21d2b8e0e8c1\",\"58dbc444-73de-46d4-b34d-41404f0f93dd\",\"191ae1c0-5117-49c0-bf05-82e9e1ffa31d\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"a2c81e60-6770-4bc4-936e-3366958432c4\",\"gridData\":{\"i\":\"a2c81e60-6770-4bc4-936e-3366958432c4\",\"y\":25,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-9] Top Targeted Audit Resources (All CCIs)\",\"panelRefName\":\"panel_e5fc529d-4431-44df-9923-6e49af1c84c5\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"description\":\"This visualization displays the top audit files or processes that are subject to access, modification, or deletion attempts. This is a vital overview for the entire **AU-9** control, encompassing aspects of **CCI-000162, CCI-000163, CCI-000164, CCI-001494, and CCI-001495**. \\n\\n**Why this visualization works:** It helps analysts quickly identify the most frequently targeted audit resources (logs or tools). A sudden spike or consistent activity on a specific audit file or process, especially by unauthorized users, can indicate a focused attack or a critical misconfiguration. This allows for targeted investigation on the most critical audit components, ensuring comprehensive protection. \\n\\n**How an analyst can use it:** Monitor for any audit files or processes with unusually high activity. Drill down into specific 'file.path' or 'process.name' entries to see the detailed events. If unauthorized attempts are concentrated on a few critical audit resources, this visualization helps pinpoint the immediate areas requiring attention for AU-9 compliance across all related CCIs. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"ad7e4d0c-2731-41e3-a9b8-7ff9ffdf8b5d\",\"filters\":[],\"query\":{\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) \",\"language\":\"kuery\"}},\"panelIndex\":\"e5fc529d-4431-44df-9923-6e49af1c84c5\",\"gridData\":{\"i\":\"e5fc529d-4431-44df-9923-6e49af1c84c5\",\"y\":55,\"x\":0,\"w\":48,\"h\":18}},{\"type\":\"lens\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Failed Audit Information Access Attempts Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"ad7e4d0c-2731-41e3-a9b8-7ff9ffdf8b5d\",\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND event.outcome:failure AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"attributes\":{\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Failed Audit Information Access Attempts Trend (converted)\",\"description\":\"This visualization displays a time-series trend of *failed* attempts to access, modify, or delete audit information or audit tools. This is directly relevant to **CCI-000162** (protecting from unauthorized access), **CCI-000163** (monitoring log integrity), and **CCI-000164** (monitoring log and tool integrity), as failed attempts indicate that protection mechanisms are in place and working, but also highlight potential threats or misconfigurations. \\n\\n**Why this visualization works:** It specifically highlights events that indicate potential unauthorized access or attempted breaches of your audit protection mechanisms. Spikes or consistent failed attempts directly point to areas needing attention, providing a clear signal of ongoing challenges to your audit security. \\n\\n**How an analyst can use it:** Look for any activity in this visualization, as a perfectly compliant system should ideally have very few, if any, failed unauthorized access attempts. Spikes in this chart demand immediate investigation. Use the time range selector to narrow down suspicious periods. This visualization is a key indicator for assessing whether the protection of audit information from unauthorized access, modification, or deletion is effective and if any active threats are present against your audit infrastructure. Remember to use the global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\"logs-*\",\"name\":\"indexpattern-datasource-layer-ba130776-3acc-4446-ba41-64ee6d2bd6c7\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"ba130776-3acc-4446-ba41-64ee6d2bd6c7\",\"accessors\":[\"ec6d3b6a-6f8f-4b15-9d7d-bf353cb3e707\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"1cc779ce-1914-4e6f-8dfe-7f08e0d78094\",\"simpleView\":false,\"splitAccessor\":\"ec4cd1bc-53c8-40b8-b294-71e9d876ca75\",\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"ec6d3b6a-6f8f-4b15-9d7d-bf353cb3e707\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND event.outcome:failure AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"ba130776-3acc-4446-ba41-64ee6d2bd6c7\":{\"ignoreGlobalFilters\":false,\"columns\":{\"1cc779ce-1914-4e6f-8dfe-7f08e0d78094\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"ec4cd1bc-53c8-40b8-b294-71e9d876ca75\":{\"label\":\"event.outcome: Descending\",\"dataType\":\"string\",\"operationType\":\"terms\",\"scale\":\"ordinal\",\"sourceField\":\"event.outcome\",\"isBucketed\":true,\"params\":{\"size\":5,\"orderBy\":{\"type\":\"column\",\"columnId\":\"ec6d3b6a-6f8f-4b15-9d7d-bf353cb3e707\"},\"orderDirection\":\"desc\",\"otherBucket\":false,\"missingBucket\":false,\"parentFormat\":{\"id\":\"terms\"},\"include\":[],\"exclude\":[],\"includeIsRegex\":false,\"excludeIsRegex\":false},\"customLabel\":true},\"ec6d3b6a-6f8f-4b15-9d7d-bf353cb3e707\":{\"label\":\"Count\",\"dataType\":\"number\",\"operationType\":\"count\",\"isBucketed\":false,\"scale\":\"ratio\",\"sourceField\":\"___records___\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"1cc779ce-1914-4e6f-8dfe-7f08e0d78094\",\"ec4cd1bc-53c8-40b8-b294-71e9d876ca75\",\"ec6d3b6a-6f8f-4b15-9d7d-bf353cb3e707\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"5e8a0475-a610-4ca7-88ba-98dfdece0303\",\"gridData\":{\"i\":\"5e8a0475-a610-4ca7-88ba-98dfdece0303\",\"y\":25,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)\",\"panelRefName\":\"panel_021ad4da-9261-4438-86bc-2eb4853a87b3\",\"embeddableConfig\":{\"description\":\"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \\n\\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \\n\\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"021ad4da-9261-4438-86bc-2eb4853a87b3\",\"gridData\":{\"i\":\"021ad4da-9261-4438-86bc-2eb4853a87b3\",\"y\":40,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Total Audit Information Access Attempts\",\"panelRefName\":\"panel_50f7aca5-a755-4f68-8ae3-094f01ac9824\",\"embeddableConfig\":{\"description\":\"This visualization displays the total count of all access attempts (both successful and failed) on audit information or audit tools. This metric is foundational for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \\n\\n**Why this visualization works:** It provides a quick, high-level understanding of the overall activity directed at protecting audit data. A sudden or sustained increase in this number, even if most attempts are failed, warrants further investigation as it can indicate increased threat activity or misconfigurations. \\n\\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for audit information protection. A continuously high count, even if not spiking, suggests a need for deeper investigation into your audit security. Remember that high numbers aren't always bad, but they should be explainable by authorized activity. For **CCI-000163** and **CCI-000164**, a high total count might indicate frequent integrity checks or, conversely, frequent attempts to compromise integrity.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"50f7aca5-a755-4f68-8ae3-094f01ac9824\",\"gridData\":{\"i\":\"50f7aca5-a755-4f68-8ae3-094f01ac9824\",\"y\":40,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-000164] Protection of Audit Information: Monitor Log & Tool Integrity ML\",\"panelRefName\":\"panel_f884c132-4943-4351-b9e3-9b690df7d576\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you assess compliance with CCI-000164, focusing on the protection of audit information and audit tools. You'll find a series of visualizations designed to highlight unauthorized access, modification, and deletion attempts on audit logs and tools. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any anomalies or failed protection mechanisms. A high number of failed attempts could indicate active threats or misconfigurations. Pay close attention to the 'user.name' field to ensure that only authorized accounts are interacting with audit data. This visualization now displays the health status of audit information protection for CCI-000164 based on the anomaly scores from associated ML jobs.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"f884c132-4943-4351-b9e3-9b690df7d576\",\"gridData\":{\"i\":\"f884c132-4943-4351-b9e3-9b690df7d576\",\"y\":0,\"x\":0,\"w\":36,\"h\":10}},{\"type\":\"visualization\",\"title\":\"[AU-9-CCIs-000162,163,164] ML - Detailed Audit Access Anomalies\",\"panelRefName\":\"panel_4f05d101-c523-41b8-9b48-9b1fb03e33a7\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of the most significant anomalies related to audit information access.\\n\\n**Why this visualization works:**\\nIt offers granular, actionable intelligence. Instead of just knowing an anomaly happened, you can see the 'who, what, and where'â€”the users, hosts, processes, and files that influenced the anomaly score. This is critical for rapid investigation and response.\\n\\n**How an analyst can use it:**\\nFilter for high anomaly scores (e.g., anomaly_score >= 75) to focus on the most critical events. Sort by `influencers.user.name` or `influencers.host.name` to identify systems or accounts exhibiting the most unusual behavior. This data helps you pinpoint the source of a potential compromise or misconfiguration.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"4f05d101-c523-41b8-9b48-9b1fb03e33a7\",\"gridData\":{\"i\":\"4f05d101-c523-41b8-9b48-9b1fb03e33a7\",\"y\":0,\"x\":36,\"w\":12,\"h\":10}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Detailed Audit Information Access Events\",\"panelRefName\":\"panel_1a687c2c-adb0-4699-8851-44b622a064ef\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of individual events related to access attempts on audit information or audit tools. This is essential for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \\n\\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, process, file involved, and the specific action attempted. This is crucial for in-depth investigation and identifying 'who', 'what', and 'where' regarding interactions with audit data, directly supporting the granular analysis required for compliance. \\n\\n**How an analyst can use it:** Sort by '@timestamp' to see the most recent events, or by 'user.name' to identify common sources of activity. Examine 'file.path' and 'process.name' to pinpoint specific audit resources being targeted. The 'event.outcome' field is critical for distinguishing between successful and failed attempts. For compliance, you should be able to explain any successful access by unauthorized users, or a high volume of failed attempts which might indicate active threats. For **CCI-000163** and **CCI-000164**, specifically look for any modification or deletion actions that were unauthorized. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to get a targeted view.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"1a687c2c-adb0-4699-8851-44b622a064ef\",\"gridData\":{\"i\":\"1a687c2c-adb0-4699-8851-44b622a064ef\",\"y\":10,\"x\":0,\"w\":48,\"h\":15}}]","timeRestore":false,"title":"[CCI-000164] CCI RMF Dashboard","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T01:02:53.198Z","created_by":"u_elastic_found","id":"7283c2f2-033b-4f75-b83e-f1412b8e4f97","managed":false,"references":[{"id":"595d3392-1102-4220-afa0-df19d4164e50","name":"e5fc529d-4431-44df-9923-6e49af1c84c5:panel_e5fc529d-4431-44df-9923-6e49af1c84c5","type":"lens"},{"id":"au-9-outcome-action-breakdown","name":"021ad4da-9261-4438-86bc-2eb4853a87b3:panel_021ad4da-9261-4438-86bc-2eb4853a87b3","type":"visualization"},{"id":"au-9-cci-core-total-attempts","name":"50f7aca5-a755-4f68-8ae3-094f01ac9824:panel_50f7aca5-a755-4f68-8ae3-094f01ac9824","type":"visualization"},{"id":"cci-000164-title","name":"f884c132-4943-4351-b9e3-9b690df7d576:panel_f884c132-4943-4351-b9e3-9b690df7d576","type":"visualization"},{"id":"au-9-cci-000162-000163-000164-ml-detailed-anomalies","name":"4f05d101-c523-41b8-9b48-9b1fb03e33a7:panel_4f05d101-c523-41b8-9b48-9b1fb03e33a7","type":"visualization"},{"id":"au-9-cci-core-detailed-events","name":"1a687c2c-adb0-4699-8851-44b622a064ef:panel_1a687c2c-adb0-4699-8851-44b622a064ef","type":"visualization"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"logs-*","name":"a2c81e60-6770-4bc4-936e-3366958432c4:indexpattern-datasource-layer-e6d810f3-4363-4bfb-b0b2-4c3ae3f80037","type":"index-pattern"},{"id":"logs-*","name":"e5fc529d-4431-44df-9923-6e49af1c84c5:indexpattern-datasource-layer-d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","type":"index-pattern"},{"id":"logs-*","name":"5e8a0475-a610-4ca7-88ba-98dfdece0303:indexpattern-datasource-layer-ba130776-3acc-4446-ba41-64ee6d2bd6c7","type":"index-pattern"},{"id":"logs-*","name":"021ad4da-9261-4438-86bc-2eb4853a87b3:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"50f7aca5-a755-4f68-8ae3-094f01ac9824:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"f884c132-4943-4351-b9e3-9b690df7d576:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"f884c132-4943-4351-b9e3-9b690df7d576:metrics_0_index_pattern","type":"index-pattern"},{"id":".ml-anomalies-*","name":"4f05d101-c523-41b8-9b48-9b1fb03e33a7:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"1a687c2c-adb0-4699-8851-44b622a064ef:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-09-10T01:45:03.567Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk4NTMsN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":16,"missingRefCount":0,"missingReferences":[]}