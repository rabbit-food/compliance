{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":2},\"event.category\":{\"count\":9},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":7},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":3},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1},\"event.timezone\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-10-07T23:31:19.611Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzEwNjcyLDdd"}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#fa7d07","description":"","name":"au-9"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:45:42.636Z","created_by":"u_elastic_found","id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T14:45:42.636Z","updated_by":"u_elastic_found","version":"WzIxNjEsMV0="}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"description":"This visualization displays the total count of all access attempts (both successful and failed) on audit information or audit tools. This metric is foundational for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \n\n**Why this visualization works:** It provides a quick, high-level understanding of the overall activity directed at protecting audit data. A sudden or sustained increase in this number, even if most attempts are failed, warrants further investigation as it can indicate increased threat activity or misconfigurations. \n\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for audit information protection. A continuously high count, even if not spiking, suggests a need for deeper investigation into your audit security. Remember that high numbers aren't always bad, but they should be explainable by authorized activity. For **CCI-000163** and **CCI-000164**, a high total count might indicate frequent integrity checks or, conversely, frequent attempts to compromise integrity.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"(\\n  (\\n    file.path : \\\"/var/log/audit/*\\\"\\n    OR file.path : \\\"/var/log/secure\\\"\\n    OR file.path : \\\"/var/log/messages\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\winevt\\\\\\\\Logs\\\\\\\\*\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\Config\\\\\\\\*\\\"\\n  )\\n  OR (event.module : (auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery) AND file.extension : (evtx OR log))\\n)\\nAND (\\n  event.action : (file_deleted OR file_modified OR file_renamed OR file_moved OR file_created OR registry_value_deleted OR registry_value_set OR registry_key_deleted OR registry_key_created OR configuration_changed OR service_configuration_changed)\\n  OR event.category : (registry OR file)\\n)\\nAND NOT (\\n  user.name : (\\\"NT AUTHORITY\\\\\\\\SYSTEM\\\" OR \\\"LocalSystem\\\" OR NetworkService OR \\\"NT AUTHORITY\\\\\\\\LOCAL SERVICE\\\" OR administrator)\\n)\\nAND NOT process.name : (filebeat OR auditbeat OR metricbeat OR winlogbeat OR nxlog.exe OR rsyslogd OR systemd-journald)\\n\",\"language\":\"kuery\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-000162, CCI-000163, CCI-000164] Total Audit Information Access Attempts","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Total Audit Information Access Attempts\",\"type\":\"metric\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"customLabel\":\"Total Attempts\",\"emptyAsNull\":false},\"schema\":\"metric\"}],\"params\":{\"addLegend\":false,\"addTooltip\":true,\"fontSize\":\"60\",\"metric\":{\"colorSchema\":\"Green to Red\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"invertColors\":false,\"labels\":{\"show\":true},\"metricColorMode\":\"None\",\"percentageMode\":false,\"style\":{\"bgColor\":false,\"bgFill\":\"#000\",\"fontSize\":60,\"labelColor\":false,\"subText\":\"\"},\"useRanges\":false},\"type\":\"metric\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-cci-core-total-attempts","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-10-16T19:13:20.870Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExODcwLDdd"}
{"attributes":{"description":"This visualization displays the top audit files or processes that are subject to access, modification, or deletion attempts. This is a vital overview for the entire **AU-9** control, encompassing aspects of **CCI-000162, CCI-000163, CCI-000164, CCI-001494, and CCI-001495**. \n\n**Why this visualization works:** It helps analysts quickly identify the most frequently targeted audit resources (logs or tools). A sudden spike or consistent activity on a specific audit file or process, especially by unauthorized users, can indicate a focused attack or a critical misconfiguration. This allows for targeted investigation on the most critical audit components, ensuring comprehensive protection. \n\n**How an analyst can use it:** Monitor for any audit files or processes with unusually high activity. Drill down into specific 'file.path' or 'process.name' entries to see the detailed events. If unauthorized attempts are concentrated on a few critical audit resources, this visualization helps pinpoint the immediate areas requiring attention for AU-9 compliance across all related CCIs. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11":{"columnOrder":["b9da6ea0-2a0f-4656-953f-c97f1b381ef2","e7eabdfb-59f1-4a23-a57d-7fd6012339ef","0731af5e-a459-4821-bb6d-7ed96645c88e"],"columns":{"0731af5e-a459-4821-bb6d-7ed96645c88e":{"dataType":"number","isBucketed":false,"label":"Count of records","operationType":"count","params":{"emptyAsNull":true},"scale":"ratio","sourceField":"___records___"},"b9da6ea0-2a0f-4656-953f-c97f1b381ef2":{"dataType":"string","isBucketed":true,"label":"Top 8 values of file.path","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"0731af5e-a459-4821-bb6d-7ed96645c88e","type":"column"},"orderDirection":"desc","otherBucket":false,"parentFormat":{"id":"terms"},"size":8},"scale":"ordinal","sourceField":"file.path"},"e7eabdfb-59f1-4a23-a57d-7fd6012339ef":{"dataType":"string","isBucketed":true,"label":"Top 6 values of process.name","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"0731af5e-a459-4821-bb6d-7ed96645c88e","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":6},"scale":"ordinal","sourceField":"process.name"}},"incompleteColumns":{},"sampling":1}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"(\n  (\n    file.path : \"/var/log/audit/*\"\n    OR file.path : \"/var/log/secure\"\n    OR file.path : \"/var/log/messages\"\n    OR file.path : \"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\"\n    OR file.path : \"C:\\\\Windows\\\\System32\\\\Config\\\\*\"\n  )\n  OR (event.module : (auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery) AND file.extension : (evtx OR log))\n)\nAND (\n  event.action : (file_deleted OR file_modified OR file_renamed OR file_moved OR file_created OR registry_value_deleted OR registry_value_set OR registry_key_deleted OR registry_key_created OR configuration_changed OR service_configuration_changed)\n  OR event.category : (registry OR file)\n)\nAND NOT (\n  user.name : (\"NT AUTHORITY\\\\SYSTEM\" OR \"LocalSystem\" OR NetworkService OR \"NT AUTHORITY\\\\LOCAL SERVICE\" OR administrator)\n)\nAND NOT process.name : (filebeat OR auditbeat OR metricbeat OR winlogbeat OR nxlog.exe OR rsyslogd OR systemd-journald)\n"},"visualization":{"axisTitlesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"fittingFunction":"Linear","gridlinesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"labelsOrientation":{"x":0,"yLeft":0,"yRight":0},"layers":[{"accessors":["0731af5e-a459-4821-bb6d-7ed96645c88e"],"colorMapping":{"assignments":[],"colorMode":{"type":"categorical"},"paletteId":"default","specialAssignments":[{"color":{"type":"loop"},"rule":{"type":"other"},"touched":false}]},"layerId":"d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","layerType":"data","seriesType":"bar_stacked","splitAccessor":"b9da6ea0-2a0f-4656-953f-c97f1b381ef2","xAccessor":"e7eabdfb-59f1-4a23-a57d-7fd6012339ef"}],"legend":{"isVisible":true,"position":"right"},"preferredSeriesType":"bar_stacked","tickLabelsVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"valueLabels":"hide"}},"title":"[AU-9] Top Targeted Audit Resources (All AU-9 CCIs)","visualizationType":"lnsXY"},"coreMigrationVersion":"8.8.0","created_at":"2025-10-16T19:46:15.541Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"595d3392-1102-4220-afa0-df19d4164e50","managed":false,"references":[{"id":"logs-*","name":"indexpattern-datasource-layer-d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-10-16T19:46:15.541Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExOTgwLDdd"}
{"attributes":{"description":"This table provides a detailed breakdown of individual events related to access attempts on audit information or audit tools. This is essential for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \n\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, process, file involved, and the specific action attempted. This is crucial for in-depth investigation and identifying 'who', 'what', and 'where' regarding interactions with audit data, directly supporting the granular analysis required for compliance. \n\n**How an analyst can use it:** Sort by '@timestamp' to see the most recent events, or by 'user.name' to identify common sources of activity. Examine 'file.path' and 'process.name' to pinpoint specific audit resources being targeted. The 'event.outcome' field is critical for distinguishing between successful and failed attempts. For compliance, you should be able to explain any successful access by unauthorized users, or a high volume of failed attempts which might indicate active threats. For **CCI-000163** and **CCI-000164**, specifically look for any modification or deletion actions that were unauthorized. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to get a targeted view.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"(\\n  (\\n    file.path : \\\"/var/log/audit/*\\\"\\n    OR file.path : \\\"/var/log/secure\\\"\\n    OR file.path : \\\"/var/log/messages\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\winevt\\\\\\\\Logs\\\\\\\\*\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\Config\\\\\\\\*\\\"\\n  )\\n  OR (event.module : (auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery) AND file.extension : (evtx OR log))\\n)\\nAND (\\n  event.action : (file_deleted OR file_modified OR file_renamed OR file_moved OR file_created OR registry_value_deleted OR registry_value_set OR registry_key_deleted OR registry_key_created OR configuration_changed OR service_configuration_changed)\\n  OR event.category : (registry OR file)\\n)\\nAND NOT (\\n  user.name : (\\\"NT AUTHORITY\\\\\\\\SYSTEM\\\" OR \\\"LocalSystem\\\" OR NetworkService OR \\\"NT AUTHORITY\\\\\\\\LOCAL SERVICE\\\" OR administrator)\\n)\\nAND NOT process.name : (filebeat OR auditbeat OR metricbeat OR winlogbeat OR nxlog.exe OR rsyslogd OR systemd-journald)\\n\",\"language\":\"kuery\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-000162, CCI-000163, CCI-000164] Detailed Audit Information Access Events","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Detailed Audit Information Access Events\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"customLabel\":\"Event Count\",\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"user.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"process.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"6\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"file.path\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"7\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.outcome\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"autoFitRowToContent\":false,\"perPage\":10,\"percentageCol\":\"\",\"showMetricsAtAllLevels\":true,\"showPartialRows\":false,\"showToolbar\":false,\"showTotal\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"totalFunc\":\"sum\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-cci-core-detailed-events","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-10-16T19:14:10.706Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExODc5LDdd"}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"color":"#10f2dd","description":"","name":"markdowntitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T17:43:11.076Z","created_by":"u_elastic_found","id":"3f2626e2-b150-4fad-93d5-75a2157a6c98","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T17:43:11.076Z","updated_by":"u_elastic_found","version":"WzI0ODIsMV0="}
{"attributes":{"description":"This section provides Machine Learning (ML) powered visualizations to help assess compliance with CCIs 000162, 000163, and 000164, which focus on protecting audit information and tools from unauthorized access. These visualizations analyze anomaly scores from ML jobs that detect unusual patterns in both successful and failed access attempts.\n\nTo perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters such as 'influencers.host.name: <your_component_name>' or 'influencers.user.name: <user_name>' to focus on a specific system or user. Observe the trends and individual anomaly events. A high anomaly score (e.g., 75 or above) indicates a significant deviation from the established baseline and warrants immediate investigation, as it could signify a sophisticated attempt to bypass security controls that rule-based alerts might miss.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9-CCIs-000162,163,164] ML - Audit Information Access Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9-CCIs-000162,163,164] ML - Audit Information Access Anomalies\",\"type\":\"markdown\",\"aggs\":[],\"params\":{\"fontSize\":12,\"markdown\":\"# [AU-9] CCIs 000162/000163/000164: Access to Audit Information (ML)\\n\\n### Monitor for anomalous access attempts on audit information and tools.\",\"openLinksInNewTab\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:30:33.016Z","created_by":"u_elastic_found","id":"au-9-cci-000162-000163-000164-ml-title","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"},{"id":"3f2626e2-b150-4fad-93d5-75a2157a6c98","name":"tag-ref-3f2626e2-b150-4fad-93d5-75a2157a6c98","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-10-16T18:23:57.790Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExNzk3LDdd"}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"description":"This section provides visualizations to help you assess compliance with CCI-000162, focusing on protecting audit information from unauthorized access. You'll find a series of visualizations designed to highlight all access attempts (both successful and failed) on audit logs and tools. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any anomalies or failed protection mechanisms. Pay close attention to 'user.name' and 'event.outcome' to ensure only authorized users are accessing audit data and that unauthorized attempts are being properly blocked. This visualization now displays the health status of audit information protection for CCI-000162 based on the anomaly scores from associated ML jobs.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-000162-000163-000164-access-attempts-trend OR job_id:au-9-cci-000162-000163-000164-failed-access-trend\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000162] Protect Audit Information from Unauthorized Access ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000162] Protect Audit Information from Unauthorized Access ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":0,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-red\",\"operator\":\"gte\"},{\"value\":20,\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-yellow\",\"operator\":\"gte\"},{\"value\":100,\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-green\",\"operator\":\"gte\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-000162-000163-000164-access-attempts-trend OR job_id:au-9-cci-000162-000163-000164-failed-access-trend\"},\"gauge_color_rules\":[],\"gauge_inner_width\":10,\"gauge_style\":\"half\",\"gauge_width\":10,\"id\":\"cci-000162-title\",\"interval\":\"\",\"isModelInvalid\":false,\"max_lines_legend\":1,\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"CCI-000162/000163/000164 Health Status\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"point_size\":1,\"separate_axis\":0,\"series_drop_last_bucket\":0,\"split_mode\":\"everything\",\"stacked\":\"none\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"tooltip_mode\":\"show_all\",\"truncate_legend\":1,\"type\":\"metric\",\"use_kibana_indexes\":true,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:38:27.855Z","created_by":"u_elastic_found","id":"cci-000162-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":".ml-anomalies-*","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-10-16T18:27:19.152Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExODA0LDdd"}
{"attributes":{"description":"This table provides a detailed breakdown of the most significant anomalies related to audit information access.\n\n**Why this visualization works:**\nIt offers granular, actionable intelligence. Instead of just knowing an anomaly happened, you can see the 'who, what, and where'—the users, hosts, processes, and files that influenced the anomaly score. This is critical for rapid investigation and response.\n\n**How an analyst can use it:**\nFilter for high anomaly scores (e.g., anomaly_score >= 75) to focus on the most critical events. Sort by `influencers.user.name` or `influencers.host.name` to identify systems or accounts exhibiting the most unusual behavior. This data helps you pinpoint the source of a potential compromise or misconfiguration.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id : (\\\"au-9-cci-000162-000163-000164-access-attempts-trend\\\" or \\\"au-9-cci-000162-000163-000164-failed-access-trend\\\") and anomaly_score >= 50\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9-CCIs-000162,163,164] ML - Detailed Audit Access Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9-CCIs-000162,163,164] ML - Detailed Audit Access Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"job_id\",\"orderBy\":\"4\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\"},\"schema\":\"metric\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:30:33.016Z","created_by":"u_elastic_found","id":"au-9-cci-000162-000163-000164-ml-detailed-anomalies","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T15:00:36.434Z","updated_by":"u_elastic_found","version":"WzE5NjcsMl0="}
{"attributes":{"description":"This visualization displays the top audit files or processes that are subject to access, modification, or deletion attempts. This is a vital overview for the entire **AU-9** control, encompassing aspects of **CCI-000162, CCI-000163, CCI-000164, CCI-001494, and CCI-001495**. \n\n**Why this visualization works:** It helps analysts quickly identify the most frequently targeted audit resources (logs or tools). A sudden spike or consistent activity on a specific audit file or process, especially by unauthorized users, can indicate a focused attack or a critical misconfiguration. This allows for targeted investigation on the most critical audit components, ensuring comprehensive protection. \n\n**How an analyst can use it:** Monitor for any audit files or processes with unusually high activity. Drill down into specific 'file.path' or 'process.name' entries to see the detailed events. If unauthorized attempts are concentrated on a few critical audit resources, this visualization helps pinpoint the immediate areas requiring attention for AU-9 compliance across all related CCIs. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"06ae043c-2003-41b4-8ec8-33a29c55fc36":{"columnOrder":["f7457e5c-816c-4a79-924f-a83d8702d16b","92f40073-0f31-413b-b263-625be0393470","a1f53b12-de4b-45d3-a194-d624d740fe33"],"columns":{"92f40073-0f31-413b-b263-625be0393470":{"dataType":"string","isBucketed":true,"label":"Top 7 values of process.name","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"a1f53b12-de4b-45d3-a194-d624d740fe33","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":7},"sourceField":"process.name"},"a1f53b12-de4b-45d3-a194-d624d740fe33":{"dataType":"number","isBucketed":false,"label":"Unique count of process.name","operationType":"unique_count","params":{"emptyAsNull":true},"sourceField":"process.name"},"f7457e5c-816c-4a79-924f-a83d8702d16b":{"dataType":"string","isBucketed":true,"label":"Top 10 values of file.name","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"a1f53b12-de4b-45d3-a194-d624d740fe33","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":10},"sourceField":"file.name"}},"ignoreGlobalFilters":false,"incompleteColumns":{},"sampling":1}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"(\n  (\n    file.path : \"/var/log/audit/*\"\n    OR file.path : \"/var/log/secure\"\n    OR file.path : \"/var/log/messages\"\n    OR file.path : \"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\"\n    OR file.path : \"C:\\\\Windows\\\\System32\\\\Config\\\\*\"\n  )\n  OR (event.module : (auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery) AND file.extension : (evtx OR log))\n)\nAND (\n  event.action : (file_deleted OR file_modified OR file_renamed OR file_moved OR file_created OR registry_value_deleted OR registry_value_set OR registry_key_deleted OR registry_key_created OR configuration_changed OR service_configuration_changed)\n  OR event.category : (registry OR file)\n)\nAND NOT (\n  user.name : (\"NT AUTHORITY\\\\SYSTEM\" OR \"LocalSystem\" OR NetworkService OR \"NT AUTHORITY\\\\LOCAL SERVICE\" OR administrator)\n)\nAND NOT process.name : (filebeat OR auditbeat OR metricbeat OR winlogbeat OR nxlog.exe OR rsyslogd OR systemd-journald)\n"},"visualization":{"gridConfig":{"isCellLabelVisible":false,"isXAxisLabelVisible":true,"isXAxisTitleVisible":false,"isYAxisLabelVisible":true,"isYAxisTitleVisible":false,"type":"heatmap_grid"},"layerId":"06ae043c-2003-41b4-8ec8-33a29c55fc36","layerType":"data","legend":{"isVisible":true,"position":"right","type":"heatmap_legend"},"shape":"heatmap","valueAccessor":"a1f53b12-de4b-45d3-a194-d624d740fe33","xAccessor":"f7457e5c-816c-4a79-924f-a83d8702d16b","yAccessor":"92f40073-0f31-413b-b263-625be0393470"}},"title":"[CCI-000162/3/4, CCI-001494/5] Top Targeted Audit Resources","visualizationType":"lnsHeatmap"},"coreMigrationVersion":"8.8.0","created_at":"2025-10-16T19:13:43.889Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"58d45062-936f-4552-8342-47b4359ed5f7","managed":false,"references":[{"id":"logs-*","name":"indexpattern-datasource-layer-06ae043c-2003-41b4-8ec8-33a29c55fc36","type":"index-pattern"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-10-16T19:13:43.889Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExODc1LDdd"}
{"attributes":{"description":"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \n\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \n\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"65503e9b-ec6a-4258-af75-53c4075ee18e":{"columnOrder":["1ad96f52-2b3a-4163-8777-e7fb1c42dfb7","ba1d2611-8c0a-4cdb-a71c-83344d542df3","6211193c-64fe-4a65-b287-6cbe7bed577d"],"columns":{"1ad96f52-2b3a-4163-8777-e7fb1c42dfb7":{"dataType":"string","isBucketed":true,"label":"Top 11 values of event.action","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"6211193c-64fe-4a65-b287-6cbe7bed577d","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":11},"sourceField":"event.action"},"6211193c-64fe-4a65-b287-6cbe7bed577d":{"dataType":"number","isBucketed":false,"label":"Count of records","operationType":"count","params":{"emptyAsNull":true},"sourceField":"___records___"},"ba1d2611-8c0a-4cdb-a71c-83344d542df3":{"dataType":"string","isBucketed":true,"label":"Top 3 values of event.outcome","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"6211193c-64fe-4a65-b287-6cbe7bed577d","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":3},"sourceField":"event.outcome"}},"incompleteColumns":{},"sampling":1}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":""},"visualization":{"layers":[{"categoryDisplay":"default","colorMapping":{"assignments":[],"colorMode":{"type":"categorical"},"paletteId":"default","specialAssignments":[{"color":{"type":"loop"},"rule":{"type":"other"},"touched":false}]},"layerId":"65503e9b-ec6a-4258-af75-53c4075ee18e","layerType":"data","legendDisplay":"default","metrics":["6211193c-64fe-4a65-b287-6cbe7bed577d"],"nestedLegend":false,"numberDisplay":"percent","primaryGroups":["1ad96f52-2b3a-4163-8777-e7fb1c42dfb7","ba1d2611-8c0a-4cdb-a71c-83344d542df3"]}],"shape":"pie"}},"title":"[AU-9] Unfiltered ALL Audit Activity Outcome and Action Breakdown","visualizationType":"lnsPie"},"coreMigrationVersion":"8.8.0","created_at":"2025-10-16T19:19:00.398Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"e2dbc1ea-6b0f-4752-8662-f6c908da4784","managed":false,"references":[{"id":"logs-*","name":"indexpattern-datasource-layer-65503e9b-ec6a-4258-af75-53c4075ee18e","type":"index-pattern"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-10-16T19:19:00.398Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExOTA4LDdd"}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"title\":\"[AU-9-CCIs-000162,163,164] ML - Audit Access Anomaly Score Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"job_id : (\\\"au-9-cci-000162-000163-000164-access-attempts-trend\\\" or \\\"au-9-cci-000162-000163-000164-failed-access-trend\\\")\"},\"attributes\":{\"title\":\"[AU-9-CCIs-000162,163,164] ML - Audit Access Anomaly Score Trend (converted)\",\"description\":\"This visualization displays the maximum anomaly score over time for jobs monitoring access to audit information.\\n\\n**Why this visualization works:**\\nIt provides a high-level overview of when anomalous activities are occurring. Unlike standard alerts, ML jobs can detect subtle or slow-developing attacks by learning the normal behavior of your systems and flagging deviations.\\n\\n**How an analyst can use it:**\\nLook for spikes in the anomaly score. A high score (e.g., 75+) indicates a significant deviation that requires investigation. Use the time selector to zoom in on specific periods of high anomalous activity and correlate with the detailed anomaly table to understand the context.\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\".ml-anomalies-*\",\"name\":\"indexpattern-datasource-layer-c4d5674d-f21f-4b1c-a38a-54c619b94693\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"legendSize\":\"auto\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"c4d5674d-f21f-4b1c-a38a-54c619b94693\",\"accessors\":[\"beb26550-ce0a-44ef-bd03-50ddbdc55e7b\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"7aab5285-4638-4df9-b424-a44b1a32b9fb\",\"simpleView\":false,\"splitAccessor\":\"d0a47b57-5453-4bab-9e0c-03000ae1b0d7\",\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"yConfig\":[{\"forAccessor\":\"beb26550-ce0a-44ef-bd03-50ddbdc55e7b\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"job_id : (\\\"au-9-cci-000162-000163-000164-access-attempts-trend\\\" or \\\"au-9-cci-000162-000163-000164-failed-access-trend\\\")\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"c4d5674d-f21f-4b1c-a38a-54c619b94693\":{\"ignoreGlobalFilters\":false,\"columns\":{\"7aab5285-4638-4df9-b424-a44b1a32b9fb\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"d0a47b57-5453-4bab-9e0c-03000ae1b0d7\":{\"label\":\"job_id: Descending\",\"dataType\":\"string\",\"operationType\":\"terms\",\"scale\":\"ordinal\",\"sourceField\":\"job_id\",\"isBucketed\":true,\"params\":{\"size\":5,\"orderBy\":{\"type\":\"alphabetical\"},\"orderDirection\":\"desc\",\"otherBucket\":false,\"missingBucket\":false,\"parentFormat\":{\"id\":\"terms\"},\"include\":[],\"exclude\":[],\"includeIsRegex\":false,\"excludeIsRegex\":false},\"customLabel\":true},\"beb26550-ce0a-44ef-bd03-50ddbdc55e7b\":{\"label\":\"Max anomaly_score\",\"dataType\":\"number\",\"operationType\":\"max\",\"sourceField\":\"anomaly_score\",\"isBucketed\":false,\"scale\":\"ratio\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"7aab5285-4638-4df9-b424-a44b1a32b9fb\",\"d0a47b57-5453-4bab-9e0c-03000ae1b0d7\",\"beb26550-ce0a-44ef-bd03-50ddbdc55e7b\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"2bd63fe3-eb9d-4401-a94b-c041f1f196f6\",\"gridData\":{\"i\":\"2bd63fe3-eb9d-4401-a94b-c041f1f196f6\",\"y\":72,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Total Audit Information Access Attempts\",\"panelRefName\":\"panel_80bd7e9b-65ad-42c6-a74b-b3bcf8e3ccdc\",\"embeddableConfig\":{\"description\":\"This visualization displays the total count of all access attempts (both successful and failed) on audit information or audit tools. This metric is foundational for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \\n\\n**Why this visualization works:** It provides a quick, high-level understanding of the overall activity directed at protecting audit data. A sudden or sustained increase in this number, even if most attempts are failed, warrants further investigation as it can indicate increased threat activity or misconfigurations. \\n\\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for audit information protection. A continuously high count, even if not spiking, suggests a need for deeper investigation into your audit security. Remember that high numbers aren't always bad, but they should be explainable by authorized activity. For **CCI-000163** and **CCI-000164**, a high total count might indicate frequent integrity checks or, conversely, frequent attempts to compromise integrity.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"80bd7e9b-65ad-42c6-a74b-b3bcf8e3ccdc\",\"gridData\":{\"i\":\"80bd7e9b-65ad-42c6-a74b-b3bcf8e3ccdc\",\"y\":57,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Audit Information Access Attempts Trend\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"attributes\":{\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Audit Information Access Attempts Trend (converted)\",\"description\":\"This visualization displays a time-series trend of all access attempts (successful and failed) on audit information or audit tools. This is crucial for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \\n\\n**Why this visualization works:** It provides a quick visual of spikes or consistent activity over time, allowing analysts to spot unusual patterns or potential attacks. Seeing both successful and failed attempts helps paint a complete picture of interaction with audit data, offering insights into both successful protection and attempted breaches. This trend helps you assess the overall security posture and effectiveness of your protection mechanisms for audit information over time. \\n\\n**How an analyst can use it:** Look for sudden increases in attempts, especially unexpected successful ones by unauthorized users, or a high volume of failed attempts. Hover over data points to see the exact count at a given time. Use the 'event.outcome' breakdown to understand if attempts are being successfully thwarted or if there are successful unauthorized accesses. For **CCI-000163** and **CCI-000164**, pay close attention to any successful attempts that might indicate a compromise of log or tool integrity. Remember to use the global filters at the top of the Kibana dashboard to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\"logs-*\",\"name\":\"indexpattern-datasource-layer-bc694746-1fd1-4685-aa9e-16d2bc3a3eec\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"bc694746-1fd1-4685-aa9e-16d2bc3a3eec\",\"accessors\":[\"a07df862-2fe4-48c6-b549-a0b4c0eeced3\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"7120f633-5f80-45f4-b12e-ce9e4b12a0f8\",\"simpleView\":false,\"splitAccessor\":\"c34adbce-5726-47de-8ad0-6e899c53a838\",\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"a07df862-2fe4-48c6-b549-a0b4c0eeced3\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"bc694746-1fd1-4685-aa9e-16d2bc3a3eec\":{\"ignoreGlobalFilters\":false,\"columns\":{\"7120f633-5f80-45f4-b12e-ce9e4b12a0f8\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"c34adbce-5726-47de-8ad0-6e899c53a838\":{\"label\":\"event.outcome: Descending\",\"dataType\":\"string\",\"operationType\":\"terms\",\"scale\":\"ordinal\",\"sourceField\":\"event.outcome\",\"isBucketed\":true,\"params\":{\"size\":5,\"orderBy\":{\"type\":\"column\",\"columnId\":\"a07df862-2fe4-48c6-b549-a0b4c0eeced3\"},\"orderDirection\":\"desc\",\"otherBucket\":false,\"missingBucket\":false,\"parentFormat\":{\"id\":\"terms\"},\"include\":[],\"exclude\":[],\"includeIsRegex\":false,\"excludeIsRegex\":false},\"customLabel\":true},\"a07df862-2fe4-48c6-b549-a0b4c0eeced3\":{\"label\":\"Count\",\"dataType\":\"number\",\"operationType\":\"count\",\"isBucketed\":false,\"scale\":\"ratio\",\"sourceField\":\"___records___\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"7120f633-5f80-45f4-b12e-ce9e4b12a0f8\",\"c34adbce-5726-47de-8ad0-6e899c53a838\",\"a07df862-2fe4-48c6-b549-a0b4c0eeced3\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"55818ebf-539d-4b53-a28c-cc1bb7673f34\",\"gridData\":{\"i\":\"55818ebf-539d-4b53-a28c-cc1bb7673f34\",\"y\":57,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Failed Audit Information Access Attempts Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND event.outcome:failure AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"attributes\":{\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Failed Audit Information Access Attempts Trend (converted)\",\"description\":\"This visualization displays a time-series trend of *failed* attempts to access, modify, or delete audit information or audit tools. This is directly relevant to **CCI-000162** (protecting from unauthorized access), **CCI-000163** (monitoring log integrity), and **CCI-000164** (monitoring log and tool integrity), as failed attempts indicate that protection mechanisms are in place and working, but also highlight potential threats or misconfigurations. \\n\\n**Why this visualization works:** It specifically highlights events that indicate potential unauthorized access or attempted breaches of your audit protection mechanisms. Spikes or consistent failed attempts directly point to areas needing attention, providing a clear signal of ongoing challenges to your audit security. \\n\\n**How an analyst can use it:** Look for any activity in this visualization, as a perfectly compliant system should ideally have very few, if any, failed unauthorized access attempts. Spikes in this chart demand immediate investigation. Use the time range selector to narrow down suspicious periods. This visualization is a key indicator for assessing whether the protection of audit information from unauthorized access, modification, or deletion is effective and if any active threats are present against your audit infrastructure. Remember to use the global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\"logs-*\",\"name\":\"indexpattern-datasource-layer-e0099a7b-7aa6-47e2-a07a-31e71ae091ea\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"e0099a7b-7aa6-47e2-a07a-31e71ae091ea\",\"accessors\":[\"64a9174b-fd5a-4970-989a-b47322db9afa\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"37e11072-0a93-4077-b571-5b802cff9700\",\"simpleView\":false,\"splitAccessor\":\"8d1e3f68-5303-4203-a18b-e5f28a9171bf\",\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"64a9174b-fd5a-4970-989a-b47322db9afa\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND event.outcome:failure AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"e0099a7b-7aa6-47e2-a07a-31e71ae091ea\":{\"ignoreGlobalFilters\":false,\"columns\":{\"37e11072-0a93-4077-b571-5b802cff9700\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"8d1e3f68-5303-4203-a18b-e5f28a9171bf\":{\"label\":\"event.outcome: Descending\",\"dataType\":\"string\",\"operationType\":\"terms\",\"scale\":\"ordinal\",\"sourceField\":\"event.outcome\",\"isBucketed\":true,\"params\":{\"size\":5,\"orderBy\":{\"type\":\"column\",\"columnId\":\"64a9174b-fd5a-4970-989a-b47322db9afa\"},\"orderDirection\":\"desc\",\"otherBucket\":false,\"missingBucket\":false,\"parentFormat\":{\"id\":\"terms\"},\"include\":[],\"exclude\":[],\"includeIsRegex\":false,\"excludeIsRegex\":false},\"customLabel\":true},\"64a9174b-fd5a-4970-989a-b47322db9afa\":{\"label\":\"Count\",\"dataType\":\"number\",\"operationType\":\"count\",\"isBucketed\":false,\"scale\":\"ratio\",\"sourceField\":\"___records___\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"37e11072-0a93-4077-b571-5b802cff9700\",\"8d1e3f68-5303-4203-a18b-e5f28a9171bf\",\"64a9174b-fd5a-4970-989a-b47322db9afa\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"43f3f6df-1f05-425e-ad6e-e45f53356c00\",\"gridData\":{\"i\":\"43f3f6df-1f05-425e-ad6e-e45f53356c00\",\"y\":72,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"panelRefName\":\"panel_fb9efa9a-2c1a-4413-baa3-c78d1155c9bd\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"query\":\"(\\n  (\\n    file.path : \\\"/var/log/audit/*\\\"\\n    OR file.path : \\\"/var/log/secure\\\"\\n    OR file.path : \\\"/var/log/messages\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\winevt\\\\\\\\Logs\\\\\\\\*\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\Config\\\\\\\\*\\\"\\n  )\\n  OR (event.module : (auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery) AND file.extension : (evtx OR log))\\n)\\nAND (\\n  event.action : (file_deleted OR file_modified OR file_renamed OR file_moved OR file_created OR registry_value_deleted OR registry_value_set OR registry_key_deleted OR registry_key_created OR configuration_changed OR service_configuration_changed)\\n  OR event.category : (registry OR file)\\n)\\nAND NOT (\\n  user.name : (\\\"NT AUTHORITY\\\\\\\\SYSTEM\\\" OR \\\"LocalSystem\\\" OR NetworkService OR \\\"NT AUTHORITY\\\\\\\\LOCAL SERVICE\\\" OR administrator)\\n)\\nAND NOT process.name : (filebeat OR auditbeat OR metricbeat OR winlogbeat OR nxlog.exe OR rsyslogd OR systemd-journald)\\n\",\"language\":\"kuery\"}},\"panelIndex\":\"fb9efa9a-2c1a-4413-baa3-c78d1155c9bd\",\"gridData\":{\"i\":\"fb9efa9a-2c1a-4413-baa3-c78d1155c9bd\",\"y\":103,\"x\":0,\"w\":48,\"h\":16}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-000162, CCI-000163, CCI-000164] Detailed Audit Information Access Events\",\"panelRefName\":\"panel_6dc82eca-f218-4e75-bfd3-b76b05fec33a\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of individual events related to access attempts on audit information or audit tools. This is essential for monitoring compliance with **CCI-000162** (protecting audit information from unauthorized access), **CCI-000163** (monitoring audit log integrity), and **CCI-000164** (monitoring audit log and tool integrity). \\n\\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, process, file involved, and the specific action attempted. This is crucial for in-depth investigation and identifying 'who', 'what', and 'where' regarding interactions with audit data, directly supporting the granular analysis required for compliance. \\n\\n**How an analyst can use it:** Sort by '@timestamp' to see the most recent events, or by 'user.name' to identify common sources of activity. Examine 'file.path' and 'process.name' to pinpoint specific audit resources being targeted. The 'event.outcome' field is critical for distinguishing between successful and failed attempts. For compliance, you should be able to explain any successful access by unauthorized users, or a high volume of failed attempts which might indicate active threats. For **CCI-000163** and **CCI-000164**, specifically look for any modification or deletion actions that were unauthorized. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to get a targeted view.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"6dc82eca-f218-4e75-bfd3-b76b05fec33a\",\"gridData\":{\"i\":\"6dc82eca-f218-4e75-bfd3-b76b05fec33a\",\"y\":40,\"x\":0,\"w\":48,\"h\":17}},{\"type\":\"visualization\",\"title\":\"[AU-9-CCIs-000162,163,164] ML - Audit Information Access Anomalies\",\"panelRefName\":\"panel_288f2947-17aa-4d45-a68c-6eab803e3fea\",\"embeddableConfig\":{\"description\":\"This section provides Machine Learning (ML) powered visualizations to help assess compliance with CCIs 000162, 000163, and 000164, which focus on protecting audit information and tools from unauthorized access. These visualizations analyze anomaly scores from ML jobs that detect unusual patterns in both successful and failed access attempts.\\n\\nTo perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters such as 'influencers.host.name: <your_component_name>' or 'influencers.user.name: <user_name>' to focus on a specific system or user. Observe the trends and individual anomaly events. A high anomaly score (e.g., 75 or above) indicates a significant deviation from the established baseline and warrants immediate investigation, as it could signify a sophisticated attempt to bypass security controls that rule-based alerts might miss.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"288f2947-17aa-4d45-a68c-6eab803e3fea\",\"gridData\":{\"i\":\"288f2947-17aa-4d45-a68c-6eab803e3fea\",\"y\":0,\"x\":0,\"w\":48,\"h\":9}},{\"type\":\"visualization\",\"title\":\"[CCI-000162] Protect Audit Information from Unauthorized Access ML\",\"panelRefName\":\"panel_c46beccb-987a-404f-99f7-4e401bbf625b\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you assess compliance with CCI-000162, focusing on protecting audit information from unauthorized access. You'll find a series of visualizations designed to highlight all access attempts (both successful and failed) on audit logs and tools. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any anomalies or failed protection mechanisms. Pay close attention to 'user.name' and 'event.outcome' to ensure only authorized users are accessing audit data and that unauthorized attempts are being properly blocked. This visualization now displays the health status of audit information protection for CCI-000162 based on the anomaly scores from associated ML jobs.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"c46beccb-987a-404f-99f7-4e401bbf625b\",\"gridData\":{\"i\":\"c46beccb-987a-404f-99f7-4e401bbf625b\",\"y\":9,\"x\":0,\"w\":48,\"h\":8}},{\"type\":\"visualization\",\"title\":\"[AU-9-CCIs-000162,163,164] ML - Detailed Audit Access Anomalies\",\"panelRefName\":\"panel_c6d4bb41-89f1-4118-b629-c5ffdd1bc194\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of the most significant anomalies related to audit information access.\\n\\n**Why this visualization works:**\\nIt offers granular, actionable intelligence. Instead of just knowing an anomaly happened, you can see the 'who, what, and where'—the users, hosts, processes, and files that influenced the anomaly score. This is critical for rapid investigation and response.\\n\\n**How an analyst can use it:**\\nFilter for high anomaly scores (e.g., anomaly_score >= 75) to focus on the most critical events. Sort by `influencers.user.name` or `influencers.host.name` to identify systems or accounts exhibiting the most unusual behavior. This data helps you pinpoint the source of a potential compromise or misconfiguration.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"c6d4bb41-89f1-4118-b629-c5ffdd1bc194\",\"gridData\":{\"i\":\"c6d4bb41-89f1-4118-b629-c5ffdd1bc194\",\"y\":87,\"x\":0,\"w\":24,\"h\":16}},{\"type\":\"lens\",\"panelRefName\":\"panel_e9af2d5c-c50e-4076-ae4d-ac03a2e15da8\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"query\":\"(\\n  (\\n    file.path : \\\"/var/log/audit/*\\\"\\n    OR file.path : \\\"/var/log/secure\\\"\\n    OR file.path : \\\"/var/log/messages\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\winevt\\\\\\\\Logs\\\\\\\\*\\\"\\n    OR file.path : \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\Config\\\\\\\\*\\\"\\n  )\\n  OR (event.module : (auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery) AND file.extension : (evtx OR log))\\n)\\nAND (\\n  event.action : (file_deleted OR file_modified OR file_renamed OR file_moved OR file_created OR registry_value_deleted OR registry_value_set OR registry_key_deleted OR registry_key_created OR configuration_changed OR service_configuration_changed)\\n  OR event.category : (registry OR file)\\n)\\nAND NOT (\\n  user.name : (\\\"NT AUTHORITY\\\\\\\\SYSTEM\\\" OR \\\"LocalSystem\\\" OR NetworkService OR \\\"NT AUTHORITY\\\\\\\\LOCAL SERVICE\\\" OR administrator)\\n)\\nAND NOT process.name : (filebeat OR auditbeat OR metricbeat OR winlogbeat OR nxlog.exe OR rsyslogd OR systemd-journald)\\n\",\"language\":\"kuery\"}},\"panelIndex\":\"e9af2d5c-c50e-4076-ae4d-ac03a2e15da8\",\"gridData\":{\"i\":\"e9af2d5c-c50e-4076-ae4d-ac03a2e15da8\",\"y\":17,\"x\":0,\"w\":48,\"h\":23}},{\"type\":\"lens\",\"panelRefName\":\"panel_95f6c2b4-00ec-4251-be4f-95f281c816f8\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}},\"panelIndex\":\"95f6c2b4-00ec-4251-be4f-95f281c816f8\",\"gridData\":{\"x\":0,\"y\":119,\"w\":24,\"h\":15,\"i\":\"95f6c2b4-00ec-4251-be4f-95f281c816f8\"}}]","refreshInterval":{"pause":true,"value":60000},"timeFrom":"now/d","timeRestore":true,"timeTo":"now/d","title":"[CCI-000162][CCI-000163][CCI-000164] CCI RMF Dashboard","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-10-16T19:54:55.091Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"2600071a-1f3d-4fba-8f06-118b19ba214e","managed":false,"references":[{"id":"au-9-cci-core-total-attempts","name":"80bd7e9b-65ad-42c6-a74b-b3bcf8e3ccdc:panel_80bd7e9b-65ad-42c6-a74b-b3bcf8e3ccdc","type":"visualization"},{"id":"595d3392-1102-4220-afa0-df19d4164e50","name":"fb9efa9a-2c1a-4413-baa3-c78d1155c9bd:panel_fb9efa9a-2c1a-4413-baa3-c78d1155c9bd","type":"lens"},{"id":"au-9-cci-core-detailed-events","name":"6dc82eca-f218-4e75-bfd3-b76b05fec33a:panel_6dc82eca-f218-4e75-bfd3-b76b05fec33a","type":"visualization"},{"id":"au-9-cci-000162-000163-000164-ml-title","name":"288f2947-17aa-4d45-a68c-6eab803e3fea:panel_288f2947-17aa-4d45-a68c-6eab803e3fea","type":"visualization"},{"id":"cci-000162-title","name":"c46beccb-987a-404f-99f7-4e401bbf625b:panel_c46beccb-987a-404f-99f7-4e401bbf625b","type":"visualization"},{"id":"au-9-cci-000162-000163-000164-ml-detailed-anomalies","name":"c6d4bb41-89f1-4118-b629-c5ffdd1bc194:panel_c6d4bb41-89f1-4118-b629-c5ffdd1bc194","type":"visualization"},{"id":"58d45062-936f-4552-8342-47b4359ed5f7","name":"e9af2d5c-c50e-4076-ae4d-ac03a2e15da8:panel_e9af2d5c-c50e-4076-ae4d-ac03a2e15da8","type":"lens"},{"id":"e2dbc1ea-6b0f-4752-8662-f6c908da4784","name":"95f6c2b4-00ec-4251-be4f-95f281c816f8:panel_95f6c2b4-00ec-4251-be4f-95f281c816f8","type":"lens"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":".ml-anomalies-*","name":"2bd63fe3-eb9d-4401-a94b-c041f1f196f6:indexpattern-datasource-layer-c4d5674d-f21f-4b1c-a38a-54c619b94693","type":"index-pattern"},{"id":"logs-*","name":"80bd7e9b-65ad-42c6-a74b-b3bcf8e3ccdc:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"55818ebf-539d-4b53-a28c-cc1bb7673f34:indexpattern-datasource-layer-bc694746-1fd1-4685-aa9e-16d2bc3a3eec","type":"index-pattern"},{"id":"logs-*","name":"43f3f6df-1f05-425e-ad6e-e45f53356c00:indexpattern-datasource-layer-e0099a7b-7aa6-47e2-a07a-31e71ae091ea","type":"index-pattern"},{"id":"logs-*","name":"fb9efa9a-2c1a-4413-baa3-c78d1155c9bd:indexpattern-datasource-layer-d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","type":"index-pattern"},{"id":"logs-*","name":"6dc82eca-f218-4e75-bfd3-b76b05fec33a:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"288f2947-17aa-4d45-a68c-6eab803e3fea:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"c46beccb-987a-404f-99f7-4e401bbf625b:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"c46beccb-987a-404f-99f7-4e401bbf625b:metrics_0_index_pattern","type":"index-pattern"},{"id":".ml-anomalies-*","name":"c6d4bb41-89f1-4118-b629-c5ffdd1bc194:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"e9af2d5c-c50e-4076-ae4d-ac03a2e15da8:indexpattern-datasource-layer-06ae043c-2003-41b4-8ec8-33a29c55fc36","type":"index-pattern"},{"id":"logs-*","name":"95f6c2b4-00ec-4251-be4f-95f281c816f8:indexpattern-datasource-layer-65503e9b-ec6a-4258-af75-53c4075ee18e","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-10-16T19:55:05.291Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzExOTk4LDdd"}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":19,"missingRefCount":0,"missingReferences":[]}