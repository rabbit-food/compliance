{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#0769a6","description":"","name":"au-3"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-02T16:48:52.095Z","created_by":"u_elastic_found","id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-08-02T16:48:52.095Z","updated_by":"u_elastic_found","version":"WzQ2NDE2LDdd"}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"description":"This visualization displays a time-series trend comparing the count of events that have user identity information with those that do not.\n\n**Why and When:** This is your first stop for assessing CCI-000133. It provides a high-level, continuous view of compliance over time. Use it to quickly determine if missing user identity is a new problem (a recent spike in red) or a chronic issue (a persistent red line). It's most effective for understanding the overall health and trends of user attribution in your logs.\n\n**How to Use:** The green area represents events where `user.name` is present, which is the desired state. The red area represents events where `user.name` is missing. For any given time period, the ratio of red to green shows your compliance level. A compliant system should have a minimal, if any, red area. If you see a significant red area, use the time selector to zoom in on that period and then use the detailed table visualization to investigate the specific non-compliant events.","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"6d2ee1a6-43de-48b5-8f58-e0ff34377a65":{"columnOrder":["2c733f50-bae7-4e39-8cc2-6b0e888fce76","49a1db65-111d-4968-962e-f5f0c1bb25c7","4a8ad9bc-5c8d-41a8-832d-2f69cb5debcc"],"columns":{"2c733f50-bae7-4e39-8cc2-6b0e888fce76":{"customLabel":true,"dataType":"date","isBucketed":true,"label":"@timestamp","operationType":"date_histogram","params":{"dropPartials":false,"includeEmptyRows":false,"interval":"auto"},"sourceField":"@timestamp"},"49a1db65-111d-4968-962e-f5f0c1bb25c7":{"dataType":"string","isBucketed":true,"label":"Filters","operationType":"filters","params":{"filters":[{"input":{"language":"kuery","query":"(user.name : * or user.id : *)"},"label":"Identity Present"},{"input":{"language":"kuery","query":"(NOT user.name : * AND NOT user.id : *)"},"label":"Identity Missing"}]}},"4a8ad9bc-5c8d-41a8-832d-2f69cb5debcc":{"customLabel":true,"dataType":"number","isBucketed":false,"label":"Count","operationType":"count","params":{"emptyAsNull":true},"sourceField":"___records___"}},"ignoreGlobalFilters":false,"incompleteColumns":{}}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"event.category:(authentication OR process OR file OR iam OR network OR registry) OR event.type:(start OR change OR creation OR deletion OR access OR logon OR policy)"},"visualization":{"axisTitlesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"curveType":"LINEAR","fittingFunction":"Linear","gridlinesVisibilitySettings":{"x":false,"yLeft":false,"yRight":true},"labelsOrientation":{"x":0,"yLeft":0,"yRight":-90},"layers":[{"accessors":["4a8ad9bc-5c8d-41a8-832d-2f69cb5debcc"],"isHistogram":true,"layerId":"6d2ee1a6-43de-48b5-8f58-e0ff34377a65","layerType":"data","palette":{"name":"default","type":"palette"},"seriesType":"area_stacked","simpleView":false,"splitAccessor":"49a1db65-111d-4968-962e-f5f0c1bb25c7","xAccessor":"2c733f50-bae7-4e39-8cc2-6b0e888fce76","xScaleType":"time","yConfig":[{"axisMode":"left","forAccessor":"4a8ad9bc-5c8d-41a8-832d-2f69cb5debcc"}]}],"legend":{"isVisible":true,"legendSize":"auto","maxLines":1,"position":"right","shouldTruncate":true,"showSingleSeries":true},"preferredSeriesType":"bar_stacked","showCurrentTimeMarker":false,"tickLabelsVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"valueLabels":"hide","yLeftExtent":{"enforce":true,"mode":"full"},"yLeftScale":"linear","yRightScale":"linear","yTitle":""}},"title":"[CCI-000133] User Identity Presence Trend (converted)","visualizationType":"lnsXY"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-03T13:51:55.452Z","created_by":"u_elastic_found","id":"9e6cf08a-5597-4ef3-bd27-b89de573d99d","managed":false,"references":[{"id":"logs-*","name":"indexpattern-datasource-layer-6d2ee1a6-43de-48b5-8f58-e0ff34377a65","type":"index-pattern"},{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-08-03T13:51:55.452Z","updated_by":"u_elastic_found","version":"WzY3NjIsN10="}
{"attributes":{"color":"#10f2dd","description":"","name":"markdowntitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T17:43:11.076Z","created_by":"u_elastic_found","id":"3f2626e2-b150-4fad-93d5-75a2157a6c98","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T17:43:11.076Z","updated_by":"u_elastic_found","version":"WzI0ODIsMV0="}
{"attributes":{"description":"This section provides visualizations to help you assess compliance with CCI-000133. The primary goal is to verify that audit records contain information establishing the identity of any individual or subject associated with an event.\n\n**Analyst Guidance for Component-Level Assessment:**\n\n1.  **Set the Scope:** Use the main Kibana dashboard filters to narrow your focus to a specific component you are assessing. For example, set `host.name: \"your-server-01\"` or `service.name: \"your-application\"`.\n\n2.  **Review the Trend:** Examine the 'User Identity Presence Trend' visualization. In a compliant system, the green line (Identity Present) should account for the vast majority of events. The red line (Identity Missing) should be at or near zero. Any significant volume of 'Identity Missing' events indicates a potential compliance gap.\n\n3.  **Investigate Missing Identity:** If you see events with missing identity, turn to the 'Hosts Generating Events Without User Identity' donut chart. This will immediately show you which hosts are the source of the non-compliant logs. \n\n4.  **Analyze Raw Events:** Use the 'Detailed Events Missing User Identity' table to investigate the specific non-compliant events. Look at the `process.name` and `event.action` to understand what is happening on the system that is generating logs without user context. This is your primary tool for root cause analysis. The goal is to determine *why* these events are not being attributed to a user and remediate the configuration on that component.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000133] Content of Audit Records","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000133] Content of Audit Records\",\"type\":\"markdown\",\"aggs\":[],\"params\":{\"markdown\":\"# [CCI-000133] Content of Audit Records\\n\\n### Verify audit records establish the identity of individuals or subjects.\",\"fontSize\":12,\"openLinksInNewTab\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-03T13:48:00.588Z","created_by":"u_elastic_found","id":"cci-000133-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"3f2626e2-b150-4fad-93d5-75a2157a6c98","name":"tag-ref-3f2626e2-b150-4fad-93d5-75a2157a6c98","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-03T13:49:27.053Z","updated_by":"u_elastic_found","version":"WzY3NTAsN10="}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"description":"This visualization displays the health status of CCI-000133 compliance based on anomaly scores from the associated ML job. High scores may indicate an anomalous number of events missing user identity information.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"},"title":"[CCI-000133] Content of Audit Records ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000133] Content of Audit Records ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":0,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"green_rule\",\"operator\":\"gte\"},{\"value\":20,\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"yellow_rule\",\"operator\":\"gte\"},{\"value\":100,\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"red_rule\",\"operator\":\"gte\"},{\"value\":null,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"7ac27481-08bb-4eac-a5b6-3a9dedbaf081\",\"operator\":\"empty\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-3-cci-000133-missing-user-identity-trend\"},\"gauge_color_rules\":[],\"gauge_inner_width\":10,\"gauge_style\":\"half\",\"gauge_width\":10,\"id\":\"3c1e82b9-5a8c-4a37-b248-0d179d72c0c0\",\"interval\":\"\",\"isModelInvalid\":false,\"max_lines_legend\":1,\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"CCI-000133 Health Status\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"point_size\":1,\"separate_axis\":0,\"series_drop_last_bucket\":0,\"split_mode\":\"everything\",\"stacked\":\"none\",\"split_color_mode\":\"gradient\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"tooltip_mode\":\"show_all\",\"truncate_legend\":1,\"type\":\"metric\",\"use_kibana_indexes\":true,\"hide_last_value_indicator\":true,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-30T13:46:58.601Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"cci-000133-title-ml","managed":false,"references":[{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":".ml-anomalies-*","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-06T23:24:33.020Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzgyMjUsN10="}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"description":"**Why and When:** This table is your primary tool for investigating CCI-000133 anomalies. It breaks down the anomalies by host, process, and event action, showing you precisely which activities are generating logs without user context.\n\n**How to Use:** Identify entries with high anomaly scores. The `host.name` and `process.name` fields tell you where the issue is occurring and what process is responsible. This allows you to investigate the logging configuration for that specific process on that host to ensure user information is correctly captured and forwarded.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id: \\\"au-3-cci-000133-missing-user-identity-trend\\\"\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-3, CCI-000133] ML - Hosts with Missing User Identities","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-3, CCI-000133] ML - Hosts with Missing User Identities\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\",\"customLabel\":\"Max Anomaly Score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"process.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-29T22:36:26.133Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"au-3-cci-000133-ml-table","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-06T23:37:50.249Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzgyNjgsN10="}
{"attributes":{"description":"This visualization shows a percentage breakdown of which hosts are generating logs that are missing user identity information.\n\n**Why and When:** Use this chart after you've identified that there's a problem with missing user data. It helps you prioritize your investigation by immediately showing which systems are the biggest offenders. If one host is responsible for 95% of the non-compliant logs, you know exactly where to start your analysis.\n\n**How to Use:** Each slice of the donut represents a host, and the size of the slice corresponds to the percentage of non-compliant logs it has generated. Hover over a slice to see the host's name and the exact count of events. Click on a slice to filter the entire dashboard to focus on just that host, allowing you to see its specific trends and detailed events in the other visualizations.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"((event.category:(authentication OR process OR file OR iam) OR event.action:(*login* OR *session* OR *sudo* OR *runas* OR *su*)) AND (NOT user.name : * AND NOT user.id : *)) AND NOT (process.name:(kernel OR systemd OR svchost.exe OR services.exe OR lsass.exe OR wininit.exe OR crond OR anacron OR atd OR udevd OR dbus-daemon) OR user.domain:(\\\"NT AUTHORITY\\\" OR \\\"LOCAL SERVICE\\\" OR \\\"NETWORK SERVICE\\\"))\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000133] Hosts Generating Events Without User Identity","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000133] Hosts Generating Events Without User Identity\",\"type\":\"pie\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"segment\"}],\"params\":{\"addTooltip\":true,\"legendPosition\":\"right\",\"isDonut\":true,\"type\":\"pie\",\"palette\":{\"type\":\"palette\",\"name\":\"kibana_palette\"},\"distinctColors\":true,\"legendDisplay\":\"show\",\"legendSize\":\"auto\",\"nestedLegend\":false,\"truncateLegend\":true,\"maxLegendLines\":1,\"emptySizeRatio\":0.3,\"labels\":{\"show\":true,\"last_level\":false,\"values\":true,\"valuesFormat\":\"percent\",\"percentDecimals\":2,\"truncate\":100,\"position\":\"default\"}}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-03T13:48:00.588Z","created_by":"u_elastic_found","id":"cci-000133-hosts-without-identity","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-03T13:51:05.486Z","updated_by":"u_elastic_found","version":"WzY3NTksN10="}
{"attributes":{"description":"This table provides a detailed list of all audit events that are missing user identity information (`user.name`).\n\n**Why and When:** Use this visualization when the trend chart shows a problem. This is your primary tool for deep-dive investigation. It provides the ground-truth data needed to identify the source of non-compliant logs and begin remediation.\n\n**How to Use:** The table is pre-filtered to show only events where `user.name` is not present. Review the `host.name`, `process.name`, and `event.action` columns to understand the context of these events. For example, you might find that a specific script running as a service (`process.name`) on a particular server (`host.name`) is responsible for the non-compliant logs. You can use the search bar at the top to further filter the results (e.g., for a specific host). This information is critical for providing actionable feedback to system administrators.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"((event.category:(authentication OR process OR file OR iam) OR event.action:(*login* OR *session* OR *sudo* OR *runas* OR *su*)) AND (NOT user.name : * AND NOT user.id : *)) AND NOT (process.name:(kernel OR systemd OR svchost.exe OR services.exe OR lsass.exe OR wininit.exe OR crond OR anacron OR atd OR udevd OR dbus-daemon) OR user.domain:(\\\"NT AUTHORITY\\\" OR \\\"LOCAL SERVICE\\\" OR \\\"NETWORK SERVICE\\\"))\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000133] Detailed Events Missing User Identity","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000133] Detailed Events Missing User Identity\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":20,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"process.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-03T13:48:00.588Z","created_by":"u_elastic_found","id":"cci-000133-detailed-events-missing-identity","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-03T13:52:59.308Z","updated_by":"u_elastic_found","version":"WzY3NjcsN10="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"panelRefName\":\"panel_5f17e6f2-0d7f-4ba4-abc5-95773fb57011\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"event.category:(authentication OR process OR file OR iam OR network OR registry) OR event.type:(start OR change OR creation OR deletion OR access OR logon OR policy)\"}},\"panelIndex\":\"5f17e6f2-0d7f-4ba4-abc5-95773fb57011\",\"gridData\":{\"i\":\"5f17e6f2-0d7f-4ba4-abc5-95773fb57011\",\"y\":18,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-000133] Content of Audit Records\",\"panelRefName\":\"panel_9cc82365-486e-4869-877f-8b311d8a8f47\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you assess compliance with CCI-000133. The primary goal is to verify that audit records contain information establishing the identity of any individual or subject associated with an event.\\n\\n**Analyst Guidance for Component-Level Assessment:**\\n\\n1.  **Set the Scope:** Use the main Kibana dashboard filters to narrow your focus to a specific component you are assessing. For example, set `host.name: \\\"your-server-01\\\"` or `service.name: \\\"your-application\\\"`.\\n\\n2.  **Review the Trend:** Examine the 'User Identity Presence Trend' visualization. In a compliant system, the green line (Identity Present) should account for the vast majority of events. The red line (Identity Missing) should be at or near zero. Any significant volume of 'Identity Missing' events indicates a potential compliance gap.\\n\\n3.  **Investigate Missing Identity:** If you see events with missing identity, turn to the 'Hosts Generating Events Without User Identity' donut chart. This will immediately show you which hosts are the source of the non-compliant logs. \\n\\n4.  **Analyze Raw Events:** Use the 'Detailed Events Missing User Identity' table to investigate the specific non-compliant events. Look at the `process.name` and `event.action` to understand what is happening on the system that is generating logs without user context. This is your primary tool for root cause analysis. The goal is to determine *why* these events are not being attributed to a user and remediate the configuration on that component.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"9cc82365-486e-4869-877f-8b311d8a8f47\",\"gridData\":{\"i\":\"9cc82365-486e-4869-877f-8b311d8a8f47\",\"y\":0,\"x\":0,\"w\":48,\"h\":7}},{\"type\":\"visualization\",\"title\":\"[CCI-000133] Content of Audit Records ML\",\"panelRefName\":\"panel_86cedfae-e42e-47b6-8122-345a6e3f9fa5\",\"embeddableConfig\":{\"description\":\"This visualization displays the health status of CCI-000133 compliance based on anomaly scores from the associated ML job. High scores may indicate an anomalous number of events missing user identity information.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"86cedfae-e42e-47b6-8122-345a6e3f9fa5\",\"gridData\":{\"i\":\"86cedfae-e42e-47b6-8122-345a6e3f9fa5\",\"y\":7,\"x\":0,\"w\":48,\"h\":11}},{\"type\":\"visualization\",\"title\":\"[AU-3, CCI-000133] ML - Hosts with Missing User Identities\",\"panelRefName\":\"panel_2c1a4d24-6a00-4109-a765-3e0ff47706df\",\"embeddableConfig\":{\"description\":\"**Why and When:** This table is your primary tool for investigating CCI-000133 anomalies. It breaks down the anomalies by host, process, and event action, showing you precisely which activities are generating logs without user context.\\n\\n**How to Use:** Identify entries with high anomaly scores. The `host.name` and `process.name` fields tell you where the issue is occurring and what process is responsible. This allows you to investigate the logging configuration for that specific process on that host to ensure user information is correctly captured and forwarded.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"2c1a4d24-6a00-4109-a765-3e0ff47706df\",\"gridData\":{\"i\":\"2c1a4d24-6a00-4109-a765-3e0ff47706df\",\"y\":51,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-3, CCI-000133] ML - Missing User Identity Anomaly Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"job_id: \\\"au-3-cci-000133-missing-user-identity-trend\\\"\"},\"attributes\":{\"title\":\"[AU-3, CCI-000133] ML - Missing User Identity Anomaly Trend (converted)\",\"description\":\"**Why and When:** This chart monitors compliance with CCI-000133, which requires audit records to identify the user associated with an event. The ML job detects anomalous spikes in events that are missing user identity information (`user.name` or `user.id`). This can highlight logging gaps or attempts to obfuscate activity.\\n\\n**How to Use:** Look for spikes in the anomaly score, which indicate a higher-than-normal rate of events without user attribution. Use the time selector to focus on these periods and then pivot to the 'Hosts with Missing User Identities' table for detailed investigation.\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\".ml-anomalies-*\",\"name\":\"indexpattern-datasource-layer-b1dbc2c7-cf61-48c4-a45c-699653f8a332\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"legendSize\":\"auto\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"b1dbc2c7-cf61-48c4-a45c-699653f8a332\",\"accessors\":[\"f0bf5e31-c673-4836-93d3-e8076cb606af\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"1ae9429c-ed4b-4a21-b055-851578197a76\",\"simpleView\":false,\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"yConfig\":[{\"forAccessor\":\"f0bf5e31-c673-4836-93d3-e8076cb606af\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"job_id: \\\"au-3-cci-000133-missing-user-identity-trend\\\"\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"b1dbc2c7-cf61-48c4-a45c-699653f8a332\":{\"ignoreGlobalFilters\":false,\"columns\":{\"1ae9429c-ed4b-4a21-b055-851578197a76\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"f0bf5e31-c673-4836-93d3-e8076cb606af\":{\"label\":\"Max anomaly_score\",\"dataType\":\"number\",\"operationType\":\"max\",\"sourceField\":\"anomaly_score\",\"isBucketed\":false,\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"1ae9429c-ed4b-4a21-b055-851578197a76\",\"f0bf5e31-c673-4836-93d3-e8076cb606af\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"d9497cff-7ada-4950-bf24-b44eb05476f6\",\"gridData\":{\"i\":\"d9497cff-7ada-4950-bf24-b44eb05476f6\",\"y\":51,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-000133] Hosts Generating Events Without User Identity\",\"panelRefName\":\"panel_ea1de28c-5c30-443e-a440-07e734481c66\",\"embeddableConfig\":{\"description\":\"This visualization shows a percentage breakdown of which hosts are generating logs that are missing user identity information.\\n\\n**Why and When:** Use this chart after you've identified that there's a problem with missing user data. It helps you prioritize your investigation by immediately showing which systems are the biggest offenders. If one host is responsible for 95% of the non-compliant logs, you know exactly where to start your analysis.\\n\\n**How to Use:** Each slice of the donut represents a host, and the size of the slice corresponds to the percentage of non-compliant logs it has generated. Hover over a slice to see the host's name and the exact count of events. Click on a slice to filter the entire dashboard to focus on just that host, allowing you to see its specific trends and detailed events in the other visualizations.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"ea1de28c-5c30-443e-a440-07e734481c66\",\"gridData\":{\"i\":\"ea1de28c-5c30-443e-a440-07e734481c66\",\"y\":18,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-000133] Detailed Events Missing User Identity\",\"panelRefName\":\"panel_e2bcc255-4ba6-4dc5-b36e-f48b12999e9d\",\"embeddableConfig\":{\"description\":\"This table provides a detailed list of all audit events that are missing user identity information (`user.name`).\\n\\n**Why and When:** Use this visualization when the trend chart shows a problem. This is your primary tool for deep-dive investigation. It provides the ground-truth data needed to identify the source of non-compliant logs and begin remediation.\\n\\n**How to Use:** The table is pre-filtered to show only events where `user.name` is not present. Review the `host.name`, `process.name`, and `event.action` columns to understand the context of these events. For example, you might find that a specific script running as a service (`process.name`) on a particular server (`host.name`) is responsible for the non-compliant logs. You can use the search bar at the top to further filter the results (e.g., for a specific host). This information is critical for providing actionable feedback to system administrators.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"e2bcc255-4ba6-4dc5-b36e-f48b12999e9d\",\"gridData\":{\"i\":\"e2bcc255-4ba6-4dc5-b36e-f48b12999e9d\",\"y\":33,\"x\":0,\"w\":48,\"h\":18}}]","timeRestore":false,"title":"AU-3 CCI-000133","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-08-03T13:48:46.857Z","created_by":"u_elastic_found","id":"964241a9-a5d0-4b9e-a6d9-daddcf2ffef3","managed":false,"references":[{"id":"9e6cf08a-5597-4ef3-bd27-b89de573d99d","name":"5f17e6f2-0d7f-4ba4-abc5-95773fb57011:panel_5f17e6f2-0d7f-4ba4-abc5-95773fb57011","type":"lens"},{"id":"cci-000133-title","name":"9cc82365-486e-4869-877f-8b311d8a8f47:panel_9cc82365-486e-4869-877f-8b311d8a8f47","type":"visualization"},{"id":"cci-000133-title-ml","name":"86cedfae-e42e-47b6-8122-345a6e3f9fa5:panel_86cedfae-e42e-47b6-8122-345a6e3f9fa5","type":"visualization"},{"id":"au-3-cci-000133-ml-table","name":"2c1a4d24-6a00-4109-a765-3e0ff47706df:panel_2c1a4d24-6a00-4109-a765-3e0ff47706df","type":"visualization"},{"id":"cci-000133-hosts-without-identity","name":"ea1de28c-5c30-443e-a440-07e734481c66:panel_ea1de28c-5c30-443e-a440-07e734481c66","type":"visualization"},{"id":"cci-000133-detailed-events-missing-identity","name":"e2bcc255-4ba6-4dc5-b36e-f48b12999e9d:panel_e2bcc255-4ba6-4dc5-b36e-f48b12999e9d","type":"visualization"},{"id":"07d17d36-0374-48e2-9653-5ccf17ca3f1d","name":"tag-ref-07d17d36-0374-48e2-9653-5ccf17ca3f1d","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"logs-*","name":"5f17e6f2-0d7f-4ba4-abc5-95773fb57011:indexpattern-datasource-layer-6d2ee1a6-43de-48b5-8f58-e0ff34377a65","type":"index-pattern"},{"id":"logs-*","name":"9cc82365-486e-4869-877f-8b311d8a8f47:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"86cedfae-e42e-47b6-8122-345a6e3f9fa5:metrics_0_index_pattern","type":"index-pattern"},{"id":".ml-anomalies-*","name":"2c1a4d24-6a00-4109-a765-3e0ff47706df:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"d9497cff-7ada-4950-bf24-b44eb05476f6:indexpattern-datasource-layer-b1dbc2c7-cf61-48c4-a45c-699653f8a332","type":"index-pattern"},{"id":"logs-*","name":"ea1de28c-5c30-443e-a440-07e734481c66:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"e2bcc255-4ba6-4dc5-b36e-f48b12999e9d:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-09-07T03:15:55.550Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzg1NDcsN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":17,"missingRefCount":0,"missingReferences":[]}